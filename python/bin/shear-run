#!/usr/bin/env python
"""
    %prog config_file

Description
    Run an image through the weak lensing code. The config file has a list
    of all input/output files and other parameters needed for the run.

        required:
            type 
                one of 'fullpipe', 'findstars','measurepsf','measureshear' 
            wl_config
            image_url
            cat_url
            stars
            fitpsf
            psf
            shear
            qa

        optional:
            nodots
            serun
            debug_level

    For examples, see the files generated by /bin/generate-se-wq
"""

import sys
from sys import stdout,stderr
import logging
import deswl

logging.basicConfig(level=logging.ERROR)

from optparse import OptionParser
parser = OptionParser(__doc__)

options, args = parser.parse_args(sys.argv[1:])

if len(args) < 1:
    parser.print_help()
    sys.exit(45)

config_file=args[0]

with open(config_file) as fobj:
    import yaml
    conf=yaml.load(fobj)

ip=deswl.wlpipe.ImageProcessor(conf)
ip.run()
