#!/usr/bin/env python
"""
    %prog [options] merun

Generate all wq job files for the given merun.
"""

import sys, os
import deswl
from deswl.files import MultishearFiles,MultishearWQJob

from optparse import OptionParser
parser = OptionParser(__doc__)
parser.add_option("-g","--groups",default=None, help="groups for queue")

def main():

    options, args = parser.parse_args(sys.argv[1:])
    if len(args) < 1:
        parser.print_help()
        sys.exit(45)

    merun=args[0]

    mfobj=MultishearFiles(merun)
    all_files=mfobj.get_flist()
    ntile=len(all_files)

    for i,fdict in enumerate(all_files):
        print '%d/%d' % (i+1,ntile)
        fdict['nodots'] = True
        mc=MultishearWQJob(merun,files=fdict,groups=options.groups)
        mc.write_all()


main()

